<div class="bg-white shadow-lg rounded-lg overflow-hidden">
  <!-- Contenedor de las imágenes con flechas -->
  <div class="relative">
    <!-- Imágenes del coche -->
    <div class="car-images" data-car-id="<%= car.id %>">
      <% car.images.each_with_index do |image, idx| %>
        <%= image_tag url_for(image), #image.variant(resize_to_limit: [600, 400]),
                      alt: car.name,
                      class: "w-full h-48 object-cover car-image #{idx.zero? ? '' : 'hidden'}",
                      data: { index: idx }
        %>
      <% end %>
    </div>

    <!-- Flecha izquierda -->
    <button class="absolute top-1/2 left-2 transform -translate-y-1/2 bg-gray-800 text-white p-2 rounded-full prev-btn" data-car-id="<%= car.id %>">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <!-- Flecha derecha -->
    <button class="absolute top-1/2 right-2 transform -translate-y-1/2 bg-gray-800 text-white p-2 rounded-full next-btn" data-car-id="<%= car.id %>">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>

  <!-- Detalles del coche -->
  <div class="p-6">
    <h2 class="text-xl font-semibold text-gray-800">
      <%= car.name %>
    </h2>
    <p class="text-gray-600 mt-2">
      Año: <%= car.year %> | Kilómetros: <%= number_with_delimiter(car.kilometers) %> km
    </p>
    <p class="text-gray-800 font-bold mt-2">
      Precio: <%= number_to_currency(car.price, unit: "€") %>
    </p>

    <!-- Enlace para ver detalles -->
    <div class="mt-4">
      <%= link_to 'Ver Detalles', car_path(car), class: "inline-block bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700" %>
    </div>
  </div>
</div>


<script>
  function changeImage(carId, direction) {
    const images = document.querySelectorAll(`.car-images[data-car-id='${carId}'] .car-image`);
    let currentIndex = Array.from(images).findIndex(image => !image.classList.contains('hidden'));

    images[currentIndex].classList.add('hidden');
    if (direction === 'next') {
      currentIndex = (currentIndex + 1) % images.length;
    } else {
      currentIndex = (currentIndex - 1 + images.length) % images.length;
    }
    images[currentIndex].classList.remove('hidden');
  }

  document.querySelectorAll('.next-btn').forEach(button => {
    button.addEventListener('click', () => {
      const carId = button.getAttribute('data-car-id');
      changeImage(carId, 'next');
    });
  });

  document.querySelectorAll('.prev-btn').forEach(button => {
    button.addEventListener('click', () => {
      const carId = button.getAttribute('data-car-id');
      changeImage(carId, 'prev');
    });
  });
</script>
